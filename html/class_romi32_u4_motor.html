<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>wpi-32u4-library: Romi32U4Motor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">wpi-32u4-library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_romi32_u4_motor-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Romi32U4Motor Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>Controls motor effort and direction on the Romi 32U4.  
 <a href="class_romi32_u4_motor.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_romi32_u4_motors_8h_source.html">Romi32U4Motors.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Romi32U4Motor:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_romi32_u4_motor.png" usemap="#Romi32U4Motor_map" alt=""/>
  <map id="Romi32U4Motor_map" name="Romi32U4Motor_map">
<area href="class_left_motor.html" alt="LeftMotor" shape="rect" coords="0,56,101,80"/>
<area href="class_right_motor.html" alt="RightMotor" shape="rect" coords="111,56,212,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa8d30ce5dbb7377e539ceb741dd6eef7"><td class="memItemLeft" align="right" valign="top"><a id="aa8d30ce5dbb7377e539ceb741dd6eef7" name="aa8d30ce5dbb7377e539ceb741dd6eef7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setPIDCoeffients</b> (float kp, float ki)</td></tr>
<tr class="separator:aa8d30ce5dbb7377e539ceb741dd6eef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e6b17fd219e90177ef5d7a0a67f6c71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#a6e6b17fd219e90177ef5d7a0a67f6c71">allowTurbo</a> (bool turbo)</td></tr>
<tr class="memdesc:a6e6b17fd219e90177ef5d7a0a67f6c71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns turbo mode on or off.  <a href="class_romi32_u4_motor.html#a6e6b17fd219e90177ef5d7a0a67f6c71">More...</a><br /></td></tr>
<tr class="separator:a6e6b17fd219e90177ef5d7a0a67f6c71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dcbe07fd3c0b36233bf279d6597bff6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#a5dcbe07fd3c0b36233bf279d6597bff6">handleISR</a> (bool newA, bool newB)</td></tr>
<tr class="separator:a5dcbe07fd3c0b36233bf279d6597bff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aba205928cb84def1037e8e1f4ea2da70"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#aba205928cb84def1037e8e1f4ea2da70">init</a> ()</td></tr>
<tr class="separator:aba205928cb84def1037e8e1f4ea2da70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-types" name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:add9f5be0c6426a1d85407243f22d1296"><td class="memItemLeft" align="right" valign="top"><a id="add9f5be0c6426a1d85407243f22d1296" name="add9f5be0c6426a1d85407243f22d1296"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>CTRL_MODE</b> : uint8_t { <b>CTRL_DIRECT</b>
, <b>CTRL_SPEED</b>
, <b>CTRL_POS</b>
 }</td></tr>
<tr class="separator:add9f5be0c6426a1d85407243f22d1296"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a9f4b56ebb68c2dba57a01fef033e90dd"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#a9f4b56ebb68c2dba57a01fef033e90dd">setEffort</a> (int16_t effort)=0</td></tr>
<tr class="memdesc:a9f4b56ebb68c2dba57a01fef033e90dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the effort for the motor directly. Overloaded for the left and right motors. Use Chassis::setEfforts() to control motors.  <a href="class_romi32_u4_motor.html#a9f4b56ebb68c2dba57a01fef033e90dd">More...</a><br /></td></tr>
<tr class="separator:a9f4b56ebb68c2dba57a01fef033e90dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bbb64334daa32c7097f7b07702dca4b"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#a4bbb64334daa32c7097f7b07702dca4b">getCount</a> (void)</td></tr>
<tr class="separator:a4bbb64334daa32c7097f7b07702dca4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4287804ecb5c971604f15c9535e67cf6"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#a4287804ecb5c971604f15c9535e67cf6">getAndResetCount</a> (void)</td></tr>
<tr class="separator:a4287804ecb5c971604f15c9535e67cf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd42875a4ab5af087dbabe0b5f270e52"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#abd42875a4ab5af087dbabe0b5f270e52">setTargetSpeed</a> (int16_t targetSpeed)</td></tr>
<tr class="separator:abd42875a4ab5af087dbabe0b5f270e52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19a4d20a4981018c9839c9939d874fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#af19a4d20a4981018c9839c9939d874fc">moveFor</a> (int16_t amount)</td></tr>
<tr class="separator:af19a4d20a4981018c9839c9939d874fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cb00ef7c2dc009c139a1dd3177ce9ce"><td class="memItemLeft" align="right" valign="top"><a id="a8cb00ef7c2dc009c139a1dd3177ce9ce" name="a8cb00ef7c2dc009c139a1dd3177ce9ce"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>checkComplete</b> (void)</td></tr>
<tr class="separator:a8cb00ef7c2dc009c139a1dd3177ce9ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada84fbdb5c7941d2a49a29a49949f5ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#ada84fbdb5c7941d2a49a29a49949f5ae">update</a> (void)</td></tr>
<tr class="separator:ada84fbdb5c7941d2a49a29a49949f5ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a866488f2e85f945cd5d65e075b8e2396"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#a866488f2e85f945cd5d65e075b8e2396">calcEncoderDelta</a> (void)</td></tr>
<tr class="separator:a866488f2e85f945cd5d65e075b8e2396"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-methods" name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:af37dba6d94328fb57f8ba2129a9fae4f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#af37dba6d94328fb57f8ba2129a9fae4f">initMotors</a> ()</td></tr>
<tr class="separator:af37dba6d94328fb57f8ba2129a9fae4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68701cf2aaceb43cdbe3b21b35d4629c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_romi32_u4_motor.html#a68701cf2aaceb43cdbe3b21b35d4629c">initEncoders</a> ()</td></tr>
<tr class="separator:a68701cf2aaceb43cdbe3b21b35d4629c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a39a5fffe36960dbca5330076ea92aa95"><td class="memItemLeft" align="right" valign="top"><a id="a39a5fffe36960dbca5330076ea92aa95" name="a39a5fffe36960dbca5330076ea92aa95"></a>
volatile CTRL_MODE&#160;</td><td class="memItemRight" valign="bottom"><b>ctrlMode</b> = CTRL_DIRECT</td></tr>
<tr class="separator:a39a5fffe36960dbca5330076ea92aa95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e7e5532dd01acc1eff9e37f213add3d"><td class="memItemLeft" align="right" valign="top"><a id="a9e7e5532dd01acc1eff9e37f213add3d" name="a9e7e5532dd01acc1eff9e37f213add3d"></a>
volatile int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>speed</b> = 0</td></tr>
<tr class="separator:a9e7e5532dd01acc1eff9e37f213add3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1afbde5181da8e7bcbdfe5b797d2c12f"><td class="memItemLeft" align="right" valign="top"><a id="a1afbde5181da8e7bcbdfe5b797d2c12f" name="a1afbde5181da8e7bcbdfe5b797d2c12f"></a>
int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>targetSpeed</b> = 0</td></tr>
<tr class="separator:a1afbde5181da8e7bcbdfe5b797d2c12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a309e9567700b49af0b0f7fcf7cc24980"><td class="memItemLeft" align="right" valign="top"><a id="a309e9567700b49af0b0f7fcf7cc24980" name="a309e9567700b49af0b0f7fcf7cc24980"></a>
int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>targetPos</b> = 0</td></tr>
<tr class="separator:a309e9567700b49af0b0f7fcf7cc24980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd51c02b3188a636e7672e60f364593"><td class="memItemLeft" align="right" valign="top"><a id="a0dd51c02b3188a636e7672e60f364593" name="a0dd51c02b3188a636e7672e60f364593"></a>
int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>maxEffort</b> = 300</td></tr>
<tr class="separator:a0dd51c02b3188a636e7672e60f364593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87576f3250707c9be89e00cbf780f015"><td class="memItemLeft" align="right" valign="top"><a id="a87576f3250707c9be89e00cbf780f015" name="a87576f3250707c9be89e00cbf780f015"></a>
volatile int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>prevCount</b> = 0</td></tr>
<tr class="separator:a87576f3250707c9be89e00cbf780f015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96d3e482d6497cf5fb7009704da7649a"><td class="memItemLeft" align="right" valign="top"><a id="a96d3e482d6497cf5fb7009704da7649a" name="a96d3e482d6497cf5fb7009704da7649a"></a>
volatile int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>count</b> = 0</td></tr>
<tr class="separator:a96d3e482d6497cf5fb7009704da7649a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5312f8cdb362ac603ca2ee46b873659b"><td class="memItemLeft" align="right" valign="top"><a id="a5312f8cdb362ac603ca2ee46b873659b" name="a5312f8cdb362ac603ca2ee46b873659b"></a>
volatile int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>lastA</b> = 0</td></tr>
<tr class="separator:a5312f8cdb362ac603ca2ee46b873659b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb06d881e836e5644d1b1012fb38945"><td class="memItemLeft" align="right" valign="top"><a id="a9fb06d881e836e5644d1b1012fb38945" name="a9fb06d881e836e5644d1b1012fb38945"></a>
volatile int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>lastB</b> = 0</td></tr>
<tr class="separator:a9fb06d881e836e5644d1b1012fb38945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05ed1097b1669064815cfdd764952f4b"><td class="memItemLeft" align="right" valign="top"><a id="a05ed1097b1669064815cfdd764952f4b" name="a05ed1097b1669064815cfdd764952f4b"></a>
<a class="el" href="class_p_i_d_controller.html">PIDController</a>&#160;</td><td class="memItemRight" valign="bottom"><b>pidCtrl</b></td></tr>
<tr class="separator:a05ed1097b1669064815cfdd764952f4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a03781c43e9a1316e852389c6fe8e412f"><td class="memItemLeft" align="right" valign="top"><a id="a03781c43e9a1316e852389c6fe8e412f" name="a03781c43e9a1316e852389c6fe8e412f"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>Chassis</b></td></tr>
<tr class="separator:a03781c43e9a1316e852389c6fe8e412f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Controls motor effort and direction on the Romi 32U4. </p>
<p >This library uses <a class="el" href="class_timer.html">Timer</a> 1, so it will conflict with any other libraries using that timer.</p>
<p >Also reads counts from the encoders on the Romi 32U4.</p>
<p >This class allows you to read counts from the encoders on the Romi 32U4, which lets you tell how much each motor has turned and in what direction.</p>
<p >The encoders are monitored in the background using interrupts, so your code can perform other tasks without missing encoder counts. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a6e6b17fd219e90177ef5d7a0a67f6c71" name="a6e6b17fd219e90177ef5d7a0a67f6c71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e6b17fd219e90177ef5d7a0a67f6c71">&#9670;&nbsp;</a></span>allowTurbo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Romi32U4Motor::allowTurbo </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>turbo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns turbo mode on or off. </p>
<p >By default turbo mode is off. When turbo mode is on, the range of speeds accepted by the other functions in this library becomes -400 to 400 (instead of -300 to 300). Turning turbo mode on allows the Romi to move faster but could decrease the lifetime of the motors.</p>
<p >This function does not have any immediate effect on the speed of the motors; it just changes the behavior of the other functions in this library.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">turbo</td><td>If true, turns turbo mode on. If false, turns turbo mode off.</td></tr>
  </table>
  </dd>
</dl>
<p>Top speed is limited to 300/420 by default. This allow you to go faster. Be careful. </p>

</div>
</div>
<a id="a866488f2e85f945cd5d65e075b8e2396" name="a866488f2e85f945cd5d65e075b8e2396"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a866488f2e85f945cd5d65e075b8e2396">&#9670;&nbsp;</a></span>calcEncoderDelta()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Romi32U4Motor::calcEncoderDelta </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p ><a class="el" href="class_romi32_u4_motor.html#a866488f2e85f945cd5d65e075b8e2396">calcEncoderDelta()</a> is called automatically by an ISR. It takes a 'snapshot of the encoders and stores the change since the last call in speed, which has units of "encoder ticks/16 ms interval"</p>
<p >Because it is called from within an ISR, interrupts don't need to be disabled. </p>

</div>
</div>
<a id="a4287804ecb5c971604f15c9535e67cf6" name="a4287804ecb5c971604f15c9535e67cf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4287804ecb5c971604f15c9535e67cf6">&#9670;&nbsp;</a></span>getAndResetCount()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int16_t Romi32U4Motor::getAndResetCount </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Resets the encoder count and returns the last count. </p>

</div>
</div>
<a id="a4bbb64334daa32c7097f7b07702dca4b" name="a4bbb64334daa32c7097f7b07702dca4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bbb64334daa32c7097f7b07702dca4b">&#9670;&nbsp;</a></span>getCount()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int16_t Romi32U4Motor::getCount </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Returns the number of counts that have been detected from the left-side encoder. These counts start at 0. Positive counts correspond to forward movement of the left side of the Romi, while negative counts correspond to backwards movement.</p>
<p >The count is returned as a signed 16-bit integer. When the count goes over 32767, it will overflow down to -32768. When the count goes below -32768, it will overflow up to 32767.</p>
<p >Returns the current encoder count. </p>

</div>
</div>
<a id="a5dcbe07fd3c0b36233bf279d6597bff6" name="a5dcbe07fd3c0b36233bf279d6597bff6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dcbe07fd3c0b36233bf279d6597bff6">&#9670;&nbsp;</a></span>handleISR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Romi32U4Motor::handleISR </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>newA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>newB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Service function for the ISR</p>
<p >Calculates the encoder counter increment/decrement due to an encoder transition. Pololu sets up their encoders in an interesting way with some logic chips, so first we have to deconvolute the encoder signals (in the ISR); then, we call this function to update the counter.</p>
<p >More details are found here:</p>
<p ><a href="https://www.pololu.com/docs/0J69/3.3">https://www.pololu.com/docs/0J69/3.3</a></p>
<p >This function is called from the ISR, which does the actual deconvolution for each motor. </p>

</div>
</div>
<a id="aba205928cb84def1037e8e1f4ea2da70" name="aba205928cb84def1037e8e1f4ea2da70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba205928cb84def1037e8e1f4ea2da70">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Romi32U4Motor::init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Must be called near the beginning of the program [usually in <a class="el" href="class_chassis.html#a4f8b23f342dc50e5e1db99ed604a158d" title="Initializes the chassis. Must be called in setup().">Chassis::init()</a>] </p>

</div>
</div>
<a id="a68701cf2aaceb43cdbe3b21b35d4629c" name="a68701cf2aaceb43cdbe3b21b35d4629c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68701cf2aaceb43cdbe3b21b35d4629c">&#9670;&nbsp;</a></span>initEncoders()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Romi32U4Motor::initEncoders </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Set up the encoder 'machinery'. Call it near the beginning of the program.</p>
<p >Do not edit this function. </p>

</div>
</div>
<a id="af37dba6d94328fb57f8ba2129a9fae4f" name="af37dba6d94328fb57f8ba2129a9fae4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af37dba6d94328fb57f8ba2129a9fae4f">&#9670;&nbsp;</a></span>initMotors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Romi32U4Motor::initMotors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p ><a class="el" href="class_romi32_u4_motor.html#af37dba6d94328fb57f8ba2129a9fae4f">initMotors()</a> should be called near the beginning of the program (usually in <a class="el" href="class_chassis.html#a4f8b23f342dc50e5e1db99ed604a158d" title="Initializes the chassis. Must be called in setup().">Chassis::init()</a>). It sets up Timer4 to run at 38 kHz, which is used to both drive the PWM signal for the motors and (tangentially) allow for a 38 kHz signal on pin 11, which can be used, say, to drive an IR LED at a common rate.</p>
<p ><a class="el" href="class_timer.html">Timer</a> 1 has the following configuration: prescaler of 1 outputs enabled on channels <a class="el" href="class_a.html">A</a> (pin 9), B (pin 10) and C (pin 11) fast PWM mode top of 420, which will be the max speed frequency is then: 16 MHz / [1 (prescaler) / (420 + 1)] = 38.005 kHz </p>

</div>
</div>
<a id="af19a4d20a4981018c9839c9939d874fc" name="af19a4d20a4981018c9839c9939d874fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af19a4d20a4981018c9839c9939d874fc">&#9670;&nbsp;</a></span>moveFor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Romi32U4Motor::moveFor </td>
          <td>(</td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>amount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Sets the (delta) target position in "encoder ticks" and a speed to drive to get there in "encoder ticks/16 ms interval" </p>

</div>
</div>
<a id="a9f4b56ebb68c2dba57a01fef033e90dd" name="a9f4b56ebb68c2dba57a01fef033e90dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f4b56ebb68c2dba57a01fef033e90dd">&#9670;&nbsp;</a></span>setEffort()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Romi32U4Motor::setEffort </td>
          <td>(</td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>effort</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the effort for the motor directly. Overloaded for the left and right motors. Use Chassis::setEfforts() to control motors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">effort</td><td><a class="el" href="class_a.html">A</a> number from -300 to 300 representing the effort and direction of the left motor. Values of -300 or less result in full effort reverse, and values of 300 or more result in full effort forward. </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="class_left_motor.html#a2c05a99b5d81aa6584773dded947bfe1">LeftMotor</a>, and <a class="el" href="class_right_motor.html#a59798d7b9dba5d7d61effbce384e30f3">RightMotor</a>.</p>

</div>
</div>
<a id="abd42875a4ab5af087dbabe0b5f270e52" name="abd42875a4ab5af087dbabe0b5f270e52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd42875a4ab5af087dbabe0b5f270e52">&#9670;&nbsp;</a></span>setTargetSpeed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Romi32U4Motor::setTargetSpeed </td>
          <td>(</td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Sets the target speed in "encoder ticks/16 ms interval" </p>

</div>
</div>
<a id="ada84fbdb5c7941d2a49a29a49949f5ae" name="ada84fbdb5c7941d2a49a29a49949f5ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada84fbdb5c7941d2a49a29a49949f5ae">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Romi32U4Motor::update </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p ><a class="el" href="class_romi32_u4_motor.html#ada84fbdb5c7941d2a49a29a49949f5ae">update()</a> must be called regularly to update the control signals sent to the motors. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="_romi32_u4_motors_8h_source.html">Romi32U4Motors.h</a></li>
<li>src/Romi32U4Encoders.cpp</li>
<li>src/Romi32U4Motors.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
